<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>databankLibrary &mdash; NMRlipids databank 4.9.2023 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=10ee5b61"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NMRlipids databank
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../listOfFiles.html">List and descriptions of NMRlipids databank files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../READMEcontent.html">User input and content of README.yaml files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addingData.html">Adding simulations into the NMRlipids databank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addingExpData.html">Adding experimental data into the NMRlipids databank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../moleculesAndMapping.html">Universal molecule and atom names</a></li>
<li class="toctree-l1"><a class="reference internal" href="../databankLibrary.html">NMRlipids databank API functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exampleAndTutorials.html">Examples and tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NMRlipids databank</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">databankLibrary</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for databankLibrary</h1><div class="highlight"><pre>
<span></span><span class="c1"># Library that contains all dictionaries and functions used in building and analyzing the NMR lipids databank</span>

<span class="c1">####################DICTIONARIES#####################################</span>
<span class="c1"># Define dictionaries</span>
<span class="c1">#</span>
<span class="c1"># Dictionary of lipids.</span>
<span class="c1">#</span>
<span class="c1"># If you add a lipid which is not yet in the databank, you have to add it here</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BufferedReader</span>
<span class="kn">import</span> <span class="nn">socket</span><span class="o">,</span> <span class="nn">urllib</span><span class="o">,</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">from</span> <span class="nn">urllib.error</span> <span class="kn">import</span> <span class="n">HTTPError</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">__pdoc__</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;__name__&quot;</span><span class="p">)</span>

<span class="n">lipids_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;POPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;POPG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;POPS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;POPE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PYPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PAzePCprot&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PAzePCdeprot&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DMPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DPPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DPPE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DPPG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DEPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DRPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DYPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DLPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DLIPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DOG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DOPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DOPE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DDOPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DOPS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DSPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DAPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DMTAP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SDG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SDPE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SOPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;POPI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SAPI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SAPI24&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SAPI25&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SLPI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;CER&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;CER180&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;CHOL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DCHOL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DHMDMAB&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DPPG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SLiPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SM16&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SM18&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TOCL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TLCL_0H&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;GM1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DPPGK&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>


<span class="c1"># Dictionary of other than lipid molecules.</span>
<span class="c1">#</span>
<span class="c1"># If you add other than a lipid molecule which is not yet in the databank, you have to add it here</span>

<span class="n">molecules_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;POT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SOD&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;CLA&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;CAL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;CES&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SOL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;C20&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>


<span class="c1"># Dictionary containing the force fields for molecules given by the contributor</span>

<span class="n">molecule_ff_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;FFPOPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFPOPG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFPOPS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFPOPE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFPYPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFPAzePCprot&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFPAzePCdeprot&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDPPG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDMPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDPPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDPPE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDEPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDRPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDYPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDLPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDLIPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDOG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDOPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDOPE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDDOPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDOPS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDSPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDAPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDMTAP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSOPC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFPOPI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSDG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSDPE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSAPI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSAPI24&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSAPI24&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSLPI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFCER&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFCER180&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFCHOL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDCHOL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDHMDMAB&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFDPPG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSM16&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSM18&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFTOCL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFGM1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DPPGK&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFPOT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSOD&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFCLA&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFCAL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFCES&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FFSOL&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>


<span class="c1"># Databank dictionary for simulations ran with Gromacs</span>

<span class="n">gromacs_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;INI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span>
            <span class="s2">&quot;gro&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pdb&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>  <span class="c1"># Could be not needed in the future (tpr)</span>
    <span class="s2">&quot;MDP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;mdp&quot;</span><span class="p">,),</span>
    <span class="p">},</span>  <span class="c1"># Could be not needed in the future (tpr)</span>
    <span class="s2">&quot;TRJ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span>
            <span class="s2">&quot;xtc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trr&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;TPR&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;tpr&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;CPT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;cpt&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;TOP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;ITP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;itp&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;LOG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;GRO&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;gro&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF_SOURCE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF_DATE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DOI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SYSTEM&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TEMPERATURE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TRJLENGTH&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PREEQTIME&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TIMELEFTOUT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;UNITEDATOM_DICT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PUBLICATION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;AUTHORS_CONTACT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SOFTWARE_VERSION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DATEOFRUNNING&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;NUMBER_OF_ATOMS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TRAJECTORY_SIZE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DIR_WRK&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;COMPOSITION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;WARNINGS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="c1"># Amber</span>
<span class="n">amber_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;TRJ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span>
            <span class="s2">&quot;nc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ncdf&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trj&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mdcrd&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;TOP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span>
            <span class="s2">&quot;prmtop&quot;</span><span class="p">,</span>
            <span class="s2">&quot;top&quot;</span><span class="p">,</span>
            <span class="s2">&quot;parm7&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF_SOURCE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF_DATE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PDB&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="s2">&quot;pdb&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DOI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SYSTEM&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TEMPERATURE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TRJLENGTH&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PREEQTIME&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TIMELEFTOUT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;UNITEDATOM_DICT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PUBLICATION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;AUTHORS_CONTACT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SOFTWARE_VERSION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DATEOFRUNNING&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;NUMBER_OF_ATOMS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TRAJECTORY_SIZE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DIR_WRK&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;COMPOSITION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="c1"># NAMD</span>
<span class="n">namd_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;TRJ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;dcd&quot;</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;INP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;.inp&quot;</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;LOG&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">),</span>
        <span class="c1"># can be parsed to get software version etc.</span>
    <span class="p">},</span>
    <span class="s2">&quot;TOP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;psf&quot;</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF_SOURCE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF_DATE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PDB&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="s2">&quot;pdb&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DOI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SYSTEM&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TEMPERATURE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TRJLENGTH&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PREEQTIME&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TIMELEFTOUT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;UNITEDATOM_DICT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PUBLICATION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;AUTHORS_CONTACT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SOFTWARE_VERSION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DATEOFRUNNING&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;NUMBER_OF_ATOMS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TRAJECTORY_SIZE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DIR_WRK&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;COMPOSITION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="c1"># CHARMM</span>
<span class="n">charmm_dict</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># OPENMM</span>
<span class="n">openmm_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;TRJ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;xtc&quot;</span><span class="p">,</span> <span class="s2">&quot;trr&quot;</span><span class="p">,</span> <span class="s2">&quot;nc&quot;</span><span class="p">,</span> <span class="s2">&quot;ncdf&quot;</span><span class="p">,</span> <span class="s2">&quot;trj&quot;</span><span class="p">,</span> <span class="s2">&quot;mdcrd&quot;</span><span class="p">,</span> <span class="s2">&quot;dcd&quot;</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;PDB&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;TOP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;psf&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;XML&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># state files from openmm, almost similar to a restart file</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;xml&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;CHK&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;chk&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;CRD&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;crd&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;INP&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># input file used to run the simulation</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EXTENSION&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;inp&quot;</span><span class="p">,),</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF_SOURCE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;FF_DATE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DOI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SYSTEM&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TEMPERATURE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TRJLENGTH&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PREEQTIME&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TIMELEFTOUT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;UNITEDATOM_DICT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;PUBLICATION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;AUTHORS_CONTACT&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;SOFTWARE_VERSION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DATEOFRUNNING&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;NUMBER_OF_ATOMS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;TRAJECTORY_SIZE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;DIR_WRK&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;COMPOSITION&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;REQUIRED&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="s2">&quot;dictionary&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="c1"># SOFTWARE</span>
<span class="n">software_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;GROMACS&quot;</span><span class="p">:</span> <span class="n">gromacs_dict</span><span class="p">,</span>
    <span class="s2">&quot;AMBER&quot;</span><span class="p">:</span> <span class="n">amber_dict</span><span class="p">,</span>
    <span class="s2">&quot;NAMD&quot;</span><span class="p">:</span> <span class="n">namd_dict</span><span class="p">,</span>
    <span class="s2">&quot;CHARMM&quot;</span><span class="p">:</span> <span class="n">charmm_dict</span><span class="p">,</span>
    <span class="s2">&quot;OPENMM&quot;</span><span class="p">:</span> <span class="n">openmm_dict</span><span class="p">,</span>
<span class="p">}</span>


<span class="c1">##############CLASS FOR LOOPING OVER SYSTEMS#######################################</span>

<span class="kn">import</span> <span class="nn">yaml</span>


<span class="k">class</span> <span class="nc">databank</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; :meta private: </span>
<span class="sd">    Representation of all simulation in the NMR lipids databank. </span>

<span class="sd">        `path` should be the local location of /Data/Simulations/ in the NMRlipids databank folder. Example usage to loop over systems: </span>
<span class="sd">   </span>
<span class="sd">            path = &#39;../../Data/Simulations/&#39;</span>
<span class="sd">            db_data = databank(path)</span>
<span class="sd">            systems = db_data.get_systems()</span>

<span class="sd">            for system in systems:</span>
<span class="sd">                print(system)</span>
<span class="sd">  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;../../Data/Simulations/&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">systems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__load_systems__</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Databank initialized from the folder:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__load_systems__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">subdir</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
                <span class="c1">#print(filepath)</span>
                <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;README.yaml&quot;</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">yaml_file</span><span class="p">:</span>
                        <span class="n">content</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">yaml_file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
                        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
                        <span class="n">sizePath</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                        <span class="n">content</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filepath</span><span class="p">[</span><span class="n">sizePath</span> <span class="p">:</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">11</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_systems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns a list of all systems in the NMRlipids databank &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">systems</span>

<span class="c1">#    def pie_temperature(self):</span>
<span class="c1">#        list_feature = [int(float(system[&quot;TEMPERATURE&quot;])) for system in self.systems]</span>
<span class="c1">#        import collections</span>

<span class="c1">#        counter = collections.Counter(list_feature)</span>
<span class="c1">#        plt.pie(counter.values(), labels=counter.keys(), normalize=True)</span>


<span class="c1">#########################FUNCTIONS###################################################</span>
<span class="c1"># functions used in building and analyzing the databank</span>

<div class="viewcode-block" id="initialize_databank">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.initialize_databank">[docs]</a>
<span class="k">def</span> <span class="nf">initialize_databank</span><span class="p">(</span><span class="n">databankPath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Intializes the NMRlipids databank.</span>

<span class="sd">    :param databankPath: path for the local location of the NMRlipids databank, for example ``../../Databank``</span>
<span class="sd">    :return: list of dictionaries that contain the content of README.yaml files for each system.  </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#sys.path.insert(1, databankPath + &#39;/Scripts/BuildDatabank/&#39;)</span>
    <span class="c1">#from databankLibrary import download_link, lipids_dict, databank</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">databankPath</span> <span class="o">+</span> <span class="s1">&#39;/Data/Simulations/&#39;</span>
    <span class="n">db_data</span> <span class="o">=</span> <span class="n">databank</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">systems</span> <span class="o">=</span> <span class="n">db_data</span><span class="o">.</span><span class="n">get_systems</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">systems</span></div>



<div class="viewcode-block" id="print_README">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.print_README">[docs]</a>
<span class="k">def</span> <span class="nf">print_README</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Prints the content of ``system`` dictionary in human readable format. </span>

<span class="sd">    :param system: NMRlipids databank dictionary defining a simulation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">system</span> <span class="o">==</span> <span class="s1">&#39;example&#39;</span><span class="p">:</span>
        <span class="n">readmePath</span> <span class="o">=</span> <span class="s1">&#39;../data/simulations/READMEexplanations.yaml&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">readmePath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">readmeFile</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">readmeFile</span> <span class="o">=</span> <span class="n">system</span>
            
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">readmeFile</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[1m&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\033</span><span class="s1">[0m&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">readmeFile</span><span class="p">[</span><span class="n">key</span><span class="p">])</span></div>




<div class="viewcode-block" id="CalcAreaPerMolecule">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.CalcAreaPerMolecule">[docs]</a>
<span class="k">def</span> <span class="nf">CalcAreaPerMolecule</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Calculates average area per lipid for a simulation defined with ``system``. </span>
<span class="sd">    It is using the ``apl.json`` file where area per lipid as a function of time calculated by the ``calcAPL.py`` is stored. </span>

<span class="sd">    :param system: NMRlipids databank dictionary defining a simulation.</span>

<span class="sd">    :return: area per lipid (Å^2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">APLpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;/../../Data/Simulations/&#39;</span> <span class="o">+</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;apl.json&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">APLpath</span><span class="p">)</span>
        <span class="n">APLdata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">sumAPL</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">sumIND</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="n">APLdata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">sumAPL</span> <span class="o">+=</span> <span class="n">j</span>
            <span class="n">sumIND</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">APL</span> <span class="o">=</span> <span class="n">sumAPL</span><span class="o">/</span><span class="n">sumIND</span>
        <span class="k">return</span><span class="p">(</span><span class="n">APL</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;apl.json not found from&#39;</span> <span class="o">+</span> <span class="n">APLpath</span><span class="p">)</span></div>

        

<div class="viewcode-block" id="GetThickness">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.GetThickness">[docs]</a>
<span class="k">def</span> <span class="nf">GetThickness</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Gets thickness for a simulation defined with ``system`` from the ``thickness.json`` file </span>
<span class="sd">    where thickness calculated by the ``calc_thickness.py`` is stored. </span>

<span class="sd">    :param system: NMRlipids databank dictionary defining a simulation.</span>

<span class="sd">    :return: membrane thickess (nm)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ThicknessPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;/../../Data/Simulations/&#39;</span> <span class="o">+</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;thickness.json&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ThicknessPath</span><span class="p">)</span>
        <span class="n">thickness</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">thickness</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span></div>

        <span class="c1">#print(&#39;thickness.json not found from&#39; + system[&#39;path&#39;])</span>


<div class="viewcode-block" id="ShowEquilibrationTimes">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.ShowEquilibrationTimes">[docs]</a>
<span class="k">def</span> <span class="nf">ShowEquilibrationTimes</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Prints relative equilibration time for each lipid within a simulation defined by ``system``. </span>
<span class="sd">    Relative equilibration times are calculated with ``NMRPCA_timerelax.py`` and stored in ``eq_times.json`` files.</span>

<span class="sd">    :param system: NMRlipids databank dictionary defining a simulation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">EqTimesPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;/../../Data/Simulations/&#39;</span> <span class="o">+</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;eq_times.json&#39;</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1">#if (os.path.isfile(EqTimesPath)):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">EqTimesPath</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">EqTimeDict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;eq_times.json not found&#39;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">EqTimeDict</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">EqTimeDict</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></div>

            
<div class="viewcode-block" id="GetNlipids">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.GetNlipids">[docs]</a>
<span class="k">def</span> <span class="nf">GetNlipids</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Returns the total number of lipids in a simulation defined by ``system``. </span>

<span class="sd">    :param system: NMRlipids databank dictionary defining a simulation.</span>

<span class="sd">    :return: the total number of lipids in the ``system``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Nlipid</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">lipids_dict</span><span class="p">:</span>
            <span class="n">Nlipid</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;COUNT&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">Nlipid</span></div>


<div class="viewcode-block" id="getLipids">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.getLipids">[docs]</a>
<span class="k">def</span> <span class="nf">getLipids</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">molecules</span><span class="o">=</span><span class="n">lipids_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a string using MDAnalysis notation that can used to select all lipids from the ``system``.</span>

<span class="sd">    :param system: NMRlipids databank dictionary defining a simulation.</span>

<span class="sd">    :return: a string using MDAnalysis notation that can used to select all lipids from the ``system``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lipids</span> <span class="o">=</span> <span class="s1">&#39;resname &#39;</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">:</span>
            <span class="n">m_file</span> <span class="o">=</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;MAPPING&#39;</span><span class="p">]</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../../Databank/Scripts/BuildDatabank/mapping_files/&#39;</span><span class="o">+</span><span class="n">m_file</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">yaml_file</span><span class="p">:</span>
                <span class="n">mapping_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">yaml_file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
                <span class="c1">#for line in f:</span>
                <span class="c1">#    if len(line.split()) &gt; 2 and &quot;Individual atoms&quot; not in line:</span>
            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mapping_dict</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">mapping_dict</span><span class="p">[</span><span class="n">atom</span><span class="p">])</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1">#        if line.split()[2] not in lipids:</span>
                    <span class="n">lipids</span> <span class="o">=</span> <span class="n">lipids</span> <span class="o">+</span> <span class="n">mapping_dict</span><span class="p">[</span><span class="n">atom</span><span class="p">][</span><span class="s1">&#39;RESIDUE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; or resname &#39;</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">lipids</span> <span class="o">=</span> <span class="n">lipids</span> <span class="o">+</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; or resname &#39;</span>
                    <span class="k">break</span>
                    <span class="c1">#continue</span>
                    <span class="c1">#else:</span>

                 
    <span class="n">lipids</span> <span class="o">=</span> <span class="n">lipids</span><span class="p">[:</span><span class="o">-</span><span class="mi">12</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lipids</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lipids</span></div>


        
<span class="n">__pdoc__</span><span class="p">[</span><span class="s1">&#39;plotFormFactor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">def</span> <span class="nf">plotFormFactor</span><span class="p">(</span><span class="n">expFormFactor</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">legend</span><span class="p">,</span><span class="n">PlotColor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;:meta private:&quot;&quot;&quot;</span>
    <span class="n">xValues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yValues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expFormFactor</span><span class="p">:</span>
        <span class="n">xValues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">yValues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xValues</span><span class="p">,</span><span class="n">yValues</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">legend</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">PlotColor</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$q_</span><span class="si">{z}</span><span class="s1"> [Å^{-1}]$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$|F(q_</span><span class="si">{z}</span><span class="s1">)|$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1">#plt.yticks(color = &#39;w&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.69</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">250</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;FormFactor.pdf&#39;</span><span class="p">)</span>


<span class="n">__pdoc__</span><span class="p">[</span><span class="s1">&#39;plotOrderParameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">def</span> <span class="nf">plotOrderParameters</span><span class="p">(</span><span class="n">OPsim</span><span class="p">,</span> <span class="n">OPexp</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;:meta private:&quot;&quot;&quot;</span>
    <span class="n">xValuesHG</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xValuesSN1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xValuesSN2</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">yValuesHGsim</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yValuesSN1sim</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yValuesSN2sim</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yValuesHGsimERR</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yValuesSN1simERR</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yValuesSN2simERR</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yValuesHGexp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yValuesSN1exp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">yValuesSN2exp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xValuesHGexp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xValuesSN1exp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xValuesSN2exp</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">sn1carbons</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;M_G1C3_M M_G1C3H1_M&#39;</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C3_M M_G1C3H2_M&#39;</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C4_M M_G1C4H1_M&#39;</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C4_M M_G1C4H2_M&#39;</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C5_M M_G1C5H1_M&#39;</span> <span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C5_M M_G1C5H2_M&#39;</span> <span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C6_M M_G1C6H1_M&#39;</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C6_M M_G1C6H2_M&#39;</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C7_M M_G1C7H1_M&#39;</span> <span class="p">:</span><span class="mi">6</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C7_M M_G1C7H2_M&#39;</span> <span class="p">:</span><span class="mi">6</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C8_M M_G1C8H1_M&#39;</span> <span class="p">:</span><span class="mi">7</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C8_M M_G1C8H2_M&#39;</span> <span class="p">:</span><span class="mi">7</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C9_M M_G1C9H1_M&#39;</span> <span class="p">:</span><span class="mi">8</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C9_M M_G1C9H2_M&#39;</span> <span class="p">:</span><span class="mi">8</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C10_M M_G1C10H1_M&#39;</span> <span class="p">:</span><span class="mi">9</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C10_M M_G1C10H2_M&#39;</span> <span class="p">:</span><span class="mi">9</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C11_M M_G1C11H1_M&#39;</span> <span class="p">:</span><span class="mi">10</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C11_M M_G1C11H2_M&#39;</span> <span class="p">:</span><span class="mi">10</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C12_M M_G1C12H1_M&#39;</span> <span class="p">:</span><span class="mi">11</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C12_M M_G1C12H2_M&#39;</span> <span class="p">:</span><span class="mi">11</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C13_M M_G1C13H1_M&#39;</span> <span class="p">:</span><span class="mi">12</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C13_M M_G1C13H2_M&#39;</span> <span class="p">:</span><span class="mi">12</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C14_M M_G1C14H1_M&#39;</span> <span class="p">:</span><span class="mi">13</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C14_M M_G1C14H2_M&#39;</span> <span class="p">:</span><span class="mi">13</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C15_M M_G1C15H1_M&#39;</span> <span class="p">:</span><span class="mi">14</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C15_M M_G1C15H2_M&#39;</span> <span class="p">:</span><span class="mi">14</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C16_M M_G1C16H1_M&#39;</span> <span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C16_M M_G1C16H2_M&#39;</span> <span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C17_M M_G1C17H1_M&#39;</span> <span class="p">:</span><span class="mi">16</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C17_M M_G1C17H2_M&#39;</span> <span class="p">:</span><span class="mi">16</span><span class="p">,</span>
                  <span class="s1">&#39;M_G1C17_M M_G1C17H3_M&#39;</span> <span class="p">:</span><span class="mi">16</span><span class="p">,</span>
                 <span class="p">}</span>
    
    <span class="n">sn2carbons</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;M_G2C3_M M_G2C3H1_M&#39;</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C3_M M_G2C3H2_M&#39;</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C4_M M_G2C4H1_M&#39;</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C4_M M_G2C4H2_M&#39;</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C5_M M_G2C5H1_M&#39;</span> <span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C5_M M_G2C5H2_M&#39;</span> <span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C6_M M_G2C6H1_M&#39;</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C6_M M_G2C6H2_M&#39;</span> <span class="p">:</span><span class="mi">5</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C7_M M_G2C7H1_M&#39;</span> <span class="p">:</span><span class="mi">6</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C7_M M_G2C7H2_M&#39;</span> <span class="p">:</span><span class="mi">6</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C8_M M_G2C8H1_M&#39;</span> <span class="p">:</span><span class="mi">7</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C8_M M_G2C8H2_M&#39;</span> <span class="p">:</span><span class="mi">7</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C9_M M_G2C9H1_M&#39;</span> <span class="p">:</span><span class="mi">8</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C9_M M_G2C9H2_M&#39;</span> <span class="p">:</span><span class="mi">8</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C10_M M_G2C10H1_M&#39;</span> <span class="p">:</span><span class="mi">9</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C10_M M_G2C10H2_M&#39;</span> <span class="p">:</span><span class="mi">9</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C11_M M_G2C11H1_M&#39;</span> <span class="p">:</span><span class="mi">10</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C11_M M_G2C11H2_M&#39;</span> <span class="p">:</span><span class="mi">10</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C12_M M_G2C12H1_M&#39;</span> <span class="p">:</span><span class="mi">11</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C12_M M_G2C12H2_M&#39;</span> <span class="p">:</span><span class="mi">11</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C13_M M_G2C13H1_M&#39;</span> <span class="p">:</span><span class="mi">12</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C13_M M_G2C13H2_M&#39;</span> <span class="p">:</span><span class="mi">12</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C14_M M_G2C14H1_M&#39;</span> <span class="p">:</span><span class="mi">13</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C14_M M_G2C14H2_M&#39;</span> <span class="p">:</span><span class="mi">13</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C15_M M_G2C15H1_M&#39;</span> <span class="p">:</span><span class="mi">14</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C15_M M_G2C15H2_M&#39;</span> <span class="p">:</span><span class="mi">14</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C16_M M_G2C16H1_M&#39;</span> <span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C16_M M_G2C16H2_M&#39;</span> <span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C17_M M_G2C17H1_M&#39;</span> <span class="p">:</span><span class="mi">16</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C17_M M_G2C17H2_M&#39;</span> <span class="p">:</span><span class="mi">16</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C17_M M_G2C17H3_M&#39;</span> <span class="p">:</span><span class="mi">16</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C18_M M_G2C18H1_M&#39;</span> <span class="p">:</span><span class="mi">17</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C18_M M_G2C18H2_M&#39;</span> <span class="p">:</span><span class="mi">17</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C18_M M_G2C18H3_M&#39;</span> <span class="p">:</span><span class="mi">17</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C19_M M_G2C19H1_M&#39;</span> <span class="p">:</span><span class="mi">18</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C19_M M_G2C19H2_M&#39;</span> <span class="p">:</span><span class="mi">18</span><span class="p">,</span>
                  <span class="s1">&#39;M_G2C19_M M_G2C19H3_M&#39;</span> <span class="p">:</span><span class="mi">18</span><span class="p">,</span>
                 <span class="p">}</span>
    
    <span class="n">HGcarbons</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;M_G3N6C1_M M_G3N6C1H1_M&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3N6C1_M M_G3N6C1H2_M&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3N6C1_M M_G3N6C1H3_M&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3N6C2_M M_G3N6C2H1_M&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3N6C2_M M_G3N6C2H2_M&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3N6C2_M M_G3N6C2H3_M&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3N6C3_M M_G3N6C3H1_M&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3N6C3_M M_G3N6C3H2_M&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3N6C3_M M_G3N6C3H3_M&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3C5_M M_G3C5H1_M&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3C5_M M_G3C5H2_M&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3C4_M M_G3C4H1_M&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3C4_M M_G3C4H2_M&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3_M M_G3H1_M&#39;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                 <span class="s1">&#39;M_G3_M M_G3H2_M&#39;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                 <span class="s1">&#39;M_G2_M M_G2H1_M&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                 <span class="s1">&#39;M_G1_M M_G1H1_M&#39;</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                 <span class="s1">&#39;M_G1_M M_G1H2_M&#39;</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                 <span class="p">}</span>
    
    
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">OPsim</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;M_G1C&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">xValuesSN1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sn1carbons</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="n">yValuesSN1sim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">OPsim</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">yValuesSN1simERR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">OPsim</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">yValuesSN1exp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">OPexp</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">xValuesSN1exp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sn1carbons</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="s1">&#39;M_G2C&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">xValuesSN2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sn2carbons</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="n">yValuesSN2sim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">OPsim</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">yValuesSN2simERR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">OPsim</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">yValuesSN2exp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">OPexp</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">xValuesSN2exp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sn2carbons</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="s1">&#39;M_G3&#39;</span> <span class="ow">in</span> <span class="n">key</span> <span class="ow">or</span> <span class="s1">&#39;M_G2_M&#39;</span> <span class="ow">in</span> <span class="n">key</span> <span class="ow">or</span> <span class="s1">&#39;M_G1_M&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">xValuesHG</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HGcarbons</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="n">yValuesHGsim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">OPsim</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">yValuesHGsimERR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">OPsim</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
                <span class="n">yValuesHGexp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">OPexp</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">xValuesHGexp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HGcarbons</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
    <span class="c1">#print(xValues,yValues)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="c1">#plt.plot(xValuesHG,yValuesHGsim,&#39;.&#39;,color=&#39;red&#39;,markersize=15)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xValuesHGexp</span><span class="p">,</span><span class="n">yValuesHGexp</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xValuesHG</span><span class="p">,</span><span class="n">yValuesHGsim</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="n">yValuesHGsimERR</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1">#plt.plot(xValuesHG,yValuesHGexp,&#39;.&#39;,color=&#39;black&#39;,markersize=15)</span>
    <span class="n">my_xticks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\u03B3</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u03B2</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\u03B1</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;$g_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="s1">&#39;$g_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="s1">&#39;$g_</span><span class="si">{3}</span><span class="s1">$&#39;</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">my_xticks</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1">#plt.xlabel(&#39;Carbon&#39;)</span>
    <span class="c1">#plt.ylim([-0.25,0.25])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1">#plt.yticks(color = &#39;w&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$S_</span><span class="si">{CH}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;HG.pdf&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="s1">&#39;sn-1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">xValuesSN1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xValuesSN1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xValuesSN1</span><span class="p">,</span><span class="n">yValuesSN1sim</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xValuesSN1exp</span><span class="p">,</span><span class="n">yValuesSN1exp</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xValuesSN1</span><span class="p">,</span><span class="n">yValuesSN1sim</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="n">yValuesSN1simERR</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xValuesSN1exp</span><span class="p">,</span><span class="n">yValuesSN1exp</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1">#plt.xlabel(&#39;Carbon&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$S_</span><span class="si">{CH}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1">#plt.yticks(color = &#39;w&#39;)</span>
    <span class="c1">#plt.ylim([-0.3,0.01])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sn-1.pdf&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="s1">&#39;sn-2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">xValuesSN2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xValuesSN2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xValuesSN2</span><span class="p">,</span><span class="n">yValuesSN2sim</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xValuesSN2exp</span><span class="p">,</span><span class="n">yValuesSN2exp</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xValuesSN2</span><span class="p">,</span><span class="n">yValuesSN2sim</span><span class="p">,</span><span class="n">yValuesSN2simERR</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xValuesSN2exp</span><span class="p">,</span><span class="n">yValuesSN2exp</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Carbon&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$S_</span><span class="si">{CH}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1">#plt.yticks(color = &#39;w&#39;)</span>
    <span class="c1">#plt.ylim([-0.25,0.01])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sn-2.pdf&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<div class="viewcode-block" id="plotSimulation">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.plotSimulation">[docs]</a>
<span class="k">def</span> <span class="nf">plotSimulation</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span> <span class="n">lipid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates plots of form factor and C-H bond order parameters for the selected ``lipid`` from a simulation with the given ``ID`` number. </span>

<span class="sd">    :param ID: NMRlipids databank ID number of the simulation</span>
<span class="sd">    :param lipid: universal molecul name of the lipid</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DataBankPath</span> <span class="o">=</span>  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;/../../&#39;</span>
    <span class="n">systems</span> <span class="o">=</span> <span class="n">initialize_databank</span><span class="p">(</span><span class="n">DataBankPath</span><span class="p">)</span>
    <span class="c1">#print(systems)</span>
    <span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">systems</span><span class="p">:</span>
        <span class="c1">#print(system)</span>
        <span class="k">if</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ID</span><span class="p">:</span>
             <span class="n">path</span> <span class="o">=</span> <span class="n">DataBankPath</span> <span class="o">+</span> <span class="s1">&#39;Data/Simulations/&#39;</span> <span class="o">+</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span>
    <span class="c1">#lipid = &#39;POPC&#39;</span>
    <span class="n">FFpathSIM</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;FormFactor.json&#39;</span>
    <span class="n">OPpathSIM</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">lipid</span> <span class="o">+</span> <span class="s1">&#39;OrderParameters.json&#39;</span>
    <span class="n">READMEfilepath</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/README.yaml&#39;</span>
    <span class="n">FFQualityFilePath</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/FormFactorQuality.json&#39;</span>

    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">READMEfilepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">yaml_file</span><span class="p">:</span>
        <span class="n">readme</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">yaml_file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
   
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DOI: &#39;</span><span class="p">,</span> <span class="n">readme</span><span class="p">[</span><span class="s1">&#39;DOI&#39;</span><span class="p">])</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">FFQualityFilePath</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">FFq</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Form factor quality: &#39;</span><span class="p">,</span> <span class="n">FFq</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">subdir</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">DataBankPath</span> <span class="o">+</span> <span class="s1">&#39;Data/experiments/FormFactors/&#39;</span> <span class="o">+</span> <span class="n">readme</span><span class="p">[</span><span class="s1">&#39;EXPERIMENT&#39;</span><span class="p">][</span><span class="s1">&#39;FORMFACTOR&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="c1">#filepath = &#39;../../Data/experiments/FormFactors/&#39; + expFFpath + &#39;/&#39; + filename</span>
                <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_FormFactor.json&#39;</span><span class="p">):</span>
                    <span class="n">FFpathEXP</span> <span class="o">=</span> <span class="n">subdir</span> <span class="o">+</span> <span class="n">filename</span>
        <span class="c1">#FFpathEXP =  DataBankPath + &#39;experiments/FormFactors/&#39; + readme[&#39;EXPERIMENT&#39;][&#39;FORMFACTOR&#39;] + &#39;/POPS_ULV_25Cin0D_SHE_FormFactor.json&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">FFpathEXP</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">FFexp</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
    
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Force field quality not found&#39;</span><span class="p">)</span>
    
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">OPpathSIM</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">OPsim</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>

    <span class="n">OPexp</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">expOPfolder</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">readme</span><span class="p">[</span><span class="s1">&#39;EXPERIMENT&#39;</span><span class="p">][</span><span class="s1">&#39;ORDERPARAMETER&#39;</span><span class="p">][</span><span class="n">lipid</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
        <span class="c1">#expOPfolder = list(readme[&#39;EXPERIMENT&#39;][&#39;ORDERPARAMETER&#39;][lipid].values())[0]</span>
        <span class="n">OPpathEXP</span> <span class="o">=</span>  <span class="n">DataBankPath</span> <span class="o">+</span> <span class="s1">&#39;Data/experiments/OrderParameters/&#39;</span> <span class="o">+</span> <span class="n">expOPfolder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">lipid</span> <span class="o">+</span> <span class="s1">&#39;_Order_Parameters.json&#39;</span>
        <span class="c1">#print(OPpathEXP)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">OPpathEXP</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">OPexp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">))</span>
    <span class="c1">#print(OPexp)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">FFpathSIM</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">FFsim</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
        <span class="n">plotFormFactor</span><span class="p">(</span><span class="n">FFsim</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Simulation&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">plotFormFactor</span><span class="p">(</span><span class="n">FFexp</span><span class="p">,</span><span class="n">FFq</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Experiment&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Form factor plotting failed&#39;</span><span class="p">)</span>
    
    <span class="n">plotOrderParameters</span><span class="p">(</span><span class="n">OPsim</span><span class="p">,</span> <span class="n">OPexp</span><span class="p">)</span></div>

    <span class="c1">#print(OPsim)</span>
    <span class="c1">#print(OPexp)</span>

        
<div class="viewcode-block" id="simulation2universal_atomnames">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.simulation2universal_atomnames">[docs]</a>
<span class="k">def</span> <span class="nf">simulation2universal_atomnames</span><span class="p">(</span><span class="n">system</span><span class="p">,</span><span class="n">molecule</span><span class="p">,</span><span class="n">atom</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get force field specific atom name corresponding to universal atom name from the ``system``.</span>

<span class="sd">    :param mapping_file: path for the mapping file</span>
<span class="sd">    :param atom1: universal atom name</span>

<span class="sd">    :return: force field specific atom name</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mapping_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;/mapping_files/&#39;</span> <span class="o">+</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;MAPPING&#39;</span><span class="p">]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mapping_file_path</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mapping_file</span><span class="p">:</span>
        <span class="n">mapping</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">mapping_file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">m_atom1</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">atom</span><span class="p">][</span><span class="s2">&quot;ATOMNAME&quot;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="s1">&#39; was not found from &#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">mapping_file_path</span><span class="p">))</span>
            <span class="k">return</span>   
    <span class="k">return</span> <span class="n">m_atom1</span></div>


<div class="viewcode-block" id="read_mapping_file">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.read_mapping_file">[docs]</a>
<span class="k">def</span> <span class="nf">read_mapping_file</span><span class="p">(</span><span class="n">mapping_file</span><span class="p">,</span> <span class="n">atom1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get force field specific atom name corresponding to universal atom name from the mapping file.</span>

<span class="sd">    :param mapping_file: path for the mapping file</span>
<span class="sd">    :param atom1: universal atom name</span>

<span class="sd">    :return: force field specific atom name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">mapping_file</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">mapping_file</span><span class="p">:</span>
        <span class="n">mapping</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">mapping_file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
        <span class="n">m_atom1</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">atom1</span><span class="p">][</span><span class="s2">&quot;ATOMNAME&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">m_atom1</span></div>


<div class="viewcode-block" id="loadMappingFile">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.loadMappingFile">[docs]</a>
<span class="k">def</span> <span class="nf">loadMappingFile</span><span class="p">(</span><span class="n">mapping_file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Load mapping file into a dictionary</span>

<span class="sd">    :param: name of the mapping file</span>
<span class="sd">    </span>
<span class="sd">    :return: mapping dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mapping_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;/mapping_files/&#39;</span> <span class="o">+</span> <span class="n">mapping_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">yaml_file</span><span class="p">:</span>
        <span class="n">mapping_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">yaml_file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
    <span class="n">yaml_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">mapping_dict</span></div>


<div class="viewcode-block" id="getAtoms">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.getAtoms">[docs]</a>
<span class="k">def</span> <span class="nf">getAtoms</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">lipid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return system specific atom names of a lipid</span>

<span class="sd">    :param system: system dictionary</span>
<span class="sd">    :param lipid: universal lipid name</span>

<span class="sd">    :return: string of system specific atom names</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">atoms</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">path_to_mapping_file</span> <span class="o">=</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">lipid</span><span class="p">][</span><span class="s1">&#39;MAPPING&#39;</span><span class="p">]</span>
    <span class="n">mapping_dict</span> <span class="o">=</span> <span class="n">loadMappingFile</span><span class="p">(</span><span class="n">path_to_mapping_file</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mapping_dict</span><span class="p">:</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">mapping_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;ATOMNAME&#39;</span><span class="p">]</span>
  
    <span class="k">return</span> <span class="n">atoms</span></div>


<div class="viewcode-block" id="getUniversalAtomName">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.getUniversalAtomName">[docs]</a>
<span class="k">def</span> <span class="nf">getUniversalAtomName</span><span class="p">(</span><span class="n">system</span><span class="p">,</span><span class="n">atomName</span><span class="p">,</span><span class="n">lipid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the universal atom name corresponding the simulation specific ``atomName`` of a ``lipid`` in a simulation defined by the ``system``.</span>

<span class="sd">    :param system: system dictionary</span>
<span class="sd">    :param atomName: simulation specific atomname</span>
<span class="sd">    :param lipid: universal lipid name</span>

<span class="sd">    :return: universal atomname (string)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mappingFile</span> <span class="o">=</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">lipid</span><span class="p">][</span><span class="s1">&#39;MAPPING&#39;</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mapping file was not found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">mappingDict</span> <span class="o">=</span> <span class="n">loadMappingFile</span><span class="p">(</span><span class="n">mappingFile</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">universalName</span> <span class="ow">in</span> <span class="n">mappingDict</span><span class="p">:</span>
        <span class="n">simName</span> <span class="o">=</span> <span class="n">mappingDict</span><span class="p">[</span><span class="n">universalName</span><span class="p">][</span><span class="s1">&#39;ATOMNAME&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">simName</span> <span class="o">==</span> <span class="n">atomName</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">universalName</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Atom was not found&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="ShowTable">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.ShowTable">[docs]</a>
<span class="k">def</span> <span class="nf">ShowTable</span><span class="p">(</span><span class="n">SortedQualities</span><span class="p">,</span> <span class="n">quality</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shows a table of simulation qualities against experimental data.</span>

<span class="sd">    :param SortedQualities: list of dictionaries to be shown, available in folder ``Data/Ranking/``</span>
<span class="sd">    :param quality: should be either ``TotalQuality`` or universal lipid name. First one shows the system total quality. Latter shows the individual lipid quality.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rounding</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;headgroup&#39;</span><span class="p">,</span> <span class="s1">&#39;sn-1&#39;</span><span class="p">,</span> <span class="s1">&#39;sn-2&#39;</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">,</span> <span class="s1">&#39;tails&#39;</span><span class="p">,</span> <span class="s1">&#39;FFQuality&#39;</span><span class="p">]</span>
    <span class="n">QualityTable</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">SortedQualities</span><span class="p">:</span>
        <span class="n">StoredToTable</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#</span>
        <span class="c1">#</span>
        <span class="c1">#print(i)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="n">quality</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1">#print(k,v)</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">rounding</span><span class="p">:</span>
                <span class="c1">#print(len(v))</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                    <span class="n">i</span><span class="p">[</span><span class="n">quality</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1">#</span>
        <span class="n">StoredToTable</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="n">quality</span><span class="p">]</span>
        <span class="n">StoredToTable</span><span class="p">[</span><span class="s1">&#39;Forcefield&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">][</span><span class="s1">&#39;FF&#39;</span><span class="p">]</span>
        <span class="n">molecules</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">MolNumbers</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">lipid</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">][</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">]:</span>
            <span class="c1">#print(np.sum(i[&#39;system&#39;][&#39;COMPOSITION&#39;][lipid][&#39;COUNT&#39;]))</span>
            <span class="n">molecules</span> <span class="o">=</span> <span class="n">molecules</span> <span class="o">+</span> <span class="n">lipid</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span>
            <span class="n">MolNumbers</span> <span class="o">=</span> <span class="n">MolNumbers</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">][</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">lipid</span><span class="p">][</span><span class="s1">&#39;COUNT&#39;</span><span class="p">]))</span>  <span class="o">+</span> <span class="s1">&#39;:&#39;</span>
        <span class="n">StoredToTable</span><span class="p">[</span><span class="s1">&#39;Molecules&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">molecules</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">StoredToTable</span><span class="p">[</span><span class="s1">&#39;Number of molecules&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">MolNumbers</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
        <span class="n">StoredToTable</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">][</span><span class="s1">&#39;TEMPERATURE&#39;</span><span class="p">]</span>
        <span class="n">StoredToTable</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">][</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span>
        <span class="n">QualityTable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StoredToTable</span><span class="p">)</span>    
    <span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">QualityTable</span><span class="p">))</span></div>






<span class="c1">#######################ORDER PARAMETERS######################################</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd"> calculation of order parameters of lipid bilayers</span>
<span class="sd"> from a MD trajectory</span>
<span class="sd"> </span>
<span class="sd"> meant for use with NMRlipids projects</span>
<span class="sd"> ------------------------------------------------------------</span>
<span class="sd"> Made by Joe,  Last edit 2017/02/02</span>
<span class="sd">------------------------------------------------------------</span>
<span class="sd"> input: Order parameter definitions</span>
<span class="sd">        gro and xtc file (or equivalents)</span>
<span class="sd"> output: order parameters (2 textfiles)</span>
<span class="sd">--------------------------------------------------------</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># coding: utf-8</span>

<span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">optparse</span> <span class="kn">import</span> <span class="n">OptionParser</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">add</span>
<span class="kn">from</span> <span class="nn">linecache</span> <span class="kn">import</span> <span class="n">getline</span>


<span class="c1"># k_b = 0.0083144621  #kJ/Mol*K</span>
<span class="c1"># f_conc=55430  # factor for calculating concentrations of salts from numbers of ions/waters; in mM/L</span>

<span class="n">bond_len_max</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># in A, max distance between atoms for reasonable OP calculation</span>
<span class="n">bond_len_max_sq</span> <span class="o">=</span> <span class="n">bond_len_max</span><span class="o">**</span><span class="mi">2</span>


<span class="c1"># %%</span>
<span class="k">class</span> <span class="nc">OrderParameter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>

<span class="sd">    Class for storing&amp;manipulating</span>
<span class="sd">    order parameter (OP) related metadata (definition, name, ...)</span>
<span class="sd">    and OP trajectories</span>
<span class="sd">    and methods to evaluate OPs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">resname</span><span class="p">,</span> <span class="n">atom_A_name</span><span class="p">,</span> <span class="n">atom_B_name</span><span class="p">,</span> <span class="n">M_atom_A_name</span><span class="p">,</span> <span class="n">M_atom_B_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span>
    <span class="p">):</span>  <span class="c1"># removed name, resname from arguments</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        it doesn&#39;t matter which comes first,</span>
<span class="sd">        atom A or B, for OP calculation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#        self.name = name             # name of the order parameter, a label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resname</span> <span class="o">=</span> <span class="n">resname</span>  <span class="c1"># name of residue atoms are in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atAname</span> <span class="o">=</span> <span class="n">atom_A_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atBname</span> <span class="o">=</span> <span class="n">atom_B_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M_atAname</span> <span class="o">=</span> <span class="n">M_atom_A_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M_atBname</span> <span class="o">=</span> <span class="n">M_atom_B_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">M_atom_A_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">M_atom_B_name</span>
        <span class="p">)</span>  <span class="c1"># generic name of atom A and atom B</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;provided name &gt;&gt; </span><span class="si">{}</span><span class="s2"> &lt;&lt; is not a string! </span><span class="se">\n</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                Unexpected behaviour might occur.&quot;</span>
                <span class="p">)</span>  <span class="c1"># .format(field)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                        <span class="s2">&quot;provided name &gt;&gt; </span><span class="si">{}</span><span class="s2"> &lt;&lt; is empty! </span><span class="se">\n</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">                    Cannot use empty names for atoms and OP definitions.&quot;</span>
                    <span class="p">)</span>  <span class="c1"># .format(field)</span>
        <span class="c1"># extra optional arguments allow setting avg,std values -- suitable for reading-in results of this script</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stem</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avg</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stem</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Number of optional positional arguments is </span><span class="si">{len}</span><span class="s2">, not 2 or 0. Args: </span><span class="si">{args}</span><span class="se">\n</span><span class="s2">Wrong file format?&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># for storing OPs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">calc_OP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        calculates Order Parameter according to equation</span>
<span class="sd">        S = 1/2 * (3*cos(theta)^2 -1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">d2</span> <span class="o">&gt;</span> <span class="n">bond_len_max_sq</span><span class="p">:</span>
            <span class="n">at1</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
            <span class="n">at2</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
            <span class="n">resnr</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">resid</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Atomic distance for atoms </span><span class="se">\</span>
<span class="s2">            </span><span class="si">{at1}</span><span class="s2"> and </span><span class="si">{at2}</span><span class="s2"> in residue no. </span><span class="si">{resnr}</span><span class="s2"> is suspiciously </span><span class="se">\</span>
<span class="s2">            long: </span><span class="si">{d}</span><span class="s2">!</span><span class="se">\n</span><span class="s2">PBC removed???&quot;</span>
            <span class="p">)</span>
        <span class="n">cos2</span> <span class="o">=</span> <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">d2</span>
        <span class="n">S</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">*</span> <span class="n">cos2</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">S</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">get_avg_std_OP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides average and stddev of all OPs in self.traj</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># convert to numpy array</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">get_avg_std_stem_OP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides average and stddev of all OPs in self.traj</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">)</span>
        <span class="c1"># convert to numpy array</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">),</span> <span class="n">std</span><span class="p">,</span> <span class="n">std</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">get_op_res</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides average and stddev of all OPs in self.traj</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># convert to numpy array</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span>


<span class="k">def</span> <span class="nf">read_trajs_calc_OPs</span><span class="p">(</span><span class="n">ordPars</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">trajs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>

<span class="sd">    procedure that</span>
<span class="sd">    creates MDAnalysis Universe with top,</span>
<span class="sd">    reads in trajectories trajs and then</span>
<span class="sd">    goes through every frame and</span>
<span class="sd">    evaluates each Order Parameter &quot;S&quot; from the list of OPs ordPars.</span>
<span class="sd">    ordPars : list of OrderParameter class</span>
<span class="sd">       each item in this list describes an Order parameter to be calculated in the trajectory</span>
<span class="sd">    top : str</span>
<span class="sd">        filename of a top file (e.g. conf.gro)</span>
<span class="sd">    trajs : list of strings</span>
<span class="sd">        filenames of trajectories</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># read-in topology and trajectory</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">trajs</span><span class="p">)</span>

    <span class="c1"># make atom selections for each OP and store it as its attribute for later use in trajectory</span>
    <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ordPars</span><span class="p">:</span>
        <span class="c1"># selection = pairs of atoms, split-by residues</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span>
            <span class="s2">&quot;resname </span><span class="si">{rnm}</span><span class="s2"> and name </span><span class="si">{atA}</span><span class="s2"> </span><span class="si">{atB}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">rnm</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">atA</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">atAname</span><span class="p">,</span> <span class="n">atB</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">atBname</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;residue&quot;</span><span class="p">)</span>
        <span class="c1">#print(op.resname + &quot; &quot; + op.atAname + &quot; &quot; + op.atBname)</span>

        <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">selection</span><span class="p">:</span>
            <span class="c1"># check if we have only 2 atoms (A &amp; B) selected</span>
            <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">n_atoms</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># print(res.resnames, res.resids)</span>
                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                    <span class="c1"># print(atom.name, atom.id)</span>
                    <span class="n">atA</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">atAname</span>
                    <span class="n">atB</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">atBname</span>
                    <span class="n">nat</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">n_atoms</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">atA</span><span class="p">,</span> <span class="n">atB</span><span class="p">,</span> <span class="n">nat</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="s2">&quot;Selection &gt;&gt; name </span><span class="si">{atA}</span><span class="s2"> </span><span class="si">{atB}</span><span class="s2"> &lt;&lt; </span><span class="se">\</span>
<span class="s2">                   contains </span><span class="si">{nat}</span><span class="s2"> atoms, but should contain exactly 2!&quot;</span>
                    <span class="p">)</span>
        <span class="n">op</span><span class="o">.</span><span class="n">selection</span> <span class="o">=</span> <span class="n">selection</span>

    <span class="c1"># go through trajectory frame-by-frame</span>
    <span class="n">Nframes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ordPars</span><span class="p">:</span>
        <span class="c1">#print(op.selection)</span>
        <span class="n">Nres</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">op</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">Nres</span>

    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">trajectory</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ordPars</span><span class="p">:</span>  <span class="c1"># .values():</span>
            <span class="n">Nres</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">selection</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nres</span><span class="p">):</span>
                <span class="n">residue</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">selection</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">calc_OP</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span>
                <span class="n">op</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span> <span class="o">/</span> <span class="n">Nframes</span>


<span class="k">def</span> <span class="nf">parse_op_input</span><span class="p">(</span><span class="n">mapping_file</span><span class="p">,</span> <span class="n">lipid_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;:meta private:&quot;&quot;&quot;</span>
    <span class="n">ordPars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">atomC</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">atomH</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">resname</span> <span class="o">=</span> <span class="n">lipid_name</span>

    <span class="n">mapping_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;../BuildDatabank/mapping_files/&quot;</span> <span class="o">+</span> <span class="n">mapping_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">yaml_file</span><span class="p">:</span>
        <span class="n">mapping_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">yaml_file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
    <span class="n">yaml_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">regexp1_H</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;M_[A-Z0-9]*C[0-9]*H[0-9]*_M&quot;</span><span class="p">)</span>
    <span class="n">regexp2_H</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;M_G[0-9]*H[0-9]*_M&quot;</span><span class="p">)</span>
    <span class="n">regexp3_H</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;M_C[0-9]*H[0-9]*_M&quot;</span><span class="p">)</span>
    <span class="n">regexp1_C</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;M_[A-Z0-9]*C[0-9]*_M&quot;</span><span class="p">)</span>
    <span class="n">regexp2_C</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;M_G[0-9]{1,2}_M&quot;</span><span class="p">)</span>
    <span class="n">regexp3_C</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;M_C[0-9]{1,2}_M&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">mapping_key</span> <span class="ow">in</span> <span class="n">mapping_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c1">#print(mapping_key)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">regexp1_C</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">mapping_key</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">regexp2_C</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">mapping_key</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">regexp3_C</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">mapping_key</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">atomC</span> <span class="o">=</span> <span class="p">[</span><span class="n">mapping_key</span><span class="p">,</span> <span class="n">mapping_dict</span><span class="p">[</span><span class="n">mapping_key</span><span class="p">][</span><span class="s2">&quot;ATOMNAME&quot;</span><span class="p">]]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">resname</span> <span class="o">=</span> <span class="n">mapping_dict</span><span class="p">[</span><span class="n">mapping_key</span><span class="p">][</span><span class="s2">&quot;RESIDUE&quot;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">atomH</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">regexp1_H</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">mapping_key</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">regexp2_H</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">mapping_key</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">regexp3_H</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">mapping_key</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">atomH</span> <span class="o">=</span> <span class="p">[</span><span class="n">mapping_key</span><span class="p">,</span> <span class="n">mapping_dict</span><span class="p">[</span><span class="n">mapping_key</span><span class="p">][</span><span class="s2">&quot;ATOMNAME&quot;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">atomC</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">atomH</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">#print(atomC)</span>
        <span class="c1">#print(atomH)</span>

        <span class="k">if</span> <span class="n">atomH</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">atomC</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cannot define carbon for the hydrogen </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">atomH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">atomH</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> 
                <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span> <span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">atomH</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">atomC</span><span class="p">):</span>
            <span class="c1">#print(resname, atomC[1], atomH[1], atomC[0], atomH[0])</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">atomC</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">atomH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">atomC</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">atomH</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">op</span> <span class="o">=</span> <span class="n">OrderParameter</span><span class="p">(</span><span class="n">resname</span><span class="p">,</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">items</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">items</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="c1">#print(op.avg,op.resname,op.atAname,op.atBname,op.selection)</span>
            <span class="n">ordPars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ordPars</span>


<span class="c1"># def parse_op_input(fname):</span>
<span class="c1">#    &quot;&quot;&quot;</span>
<span class="c1">#    parses input file with Order Parameter definitions</span>
<span class="c1">#    file format is as follows:</span>
<span class="c1">#    OP_name    resname    atom1    atom2</span>
<span class="c1">#    (flexible cols)</span>
<span class="c1">#    fname : string</span>
<span class="c1">#        input file name</span>
<span class="c1">#    returns : dictionary</span>
<span class="c1">#        with OrderParameters class instances</span>
<span class="c1">#    &quot;&quot;&quot;</span>
<span class="c1">#    ordPars = OrderedDict()</span>
<span class="c1">#    try:</span>
<span class="c1">#        with open(fname,&quot;r&quot;) as f:</span>
<span class="c1">#            for line in f.readlines():</span>
<span class="c1">#                if not line.startswith(&quot;#&quot;):</span>
<span class="c1">#                    items = line.split()</span>
<span class="c1">#</span>
<span class="c1">#                    ordPars[items[0]] = OrderParameter(*items)</span>
<span class="c1">#</span>
<span class="c1">#    except:</span>
<span class="c1">#        inpf=opts.inp_fname</span>
<span class="c1">#        raise RuntimeError(&quot;Couldn&#39;t read input file &gt;&gt; {inpf} &lt;&lt;&quot;)</span>
<span class="c1">#    return ordPars</span>


<span class="c1"># %%</span>


<span class="k">def</span> <span class="nf">find_OP</span><span class="p">(</span><span class="n">inp_fname</span><span class="p">,</span> <span class="n">top_fname</span><span class="p">,</span> <span class="n">traj_fname</span><span class="p">,</span> <span class="n">lipid_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;    :meta private:&quot;&quot;&quot;</span>
    <span class="n">ordPars</span> <span class="o">=</span> <span class="n">parse_op_input</span><span class="p">(</span><span class="n">inp_fname</span><span class="p">,</span> <span class="n">lipid_name</span><span class="p">)</span>

    <span class="n">read_trajs_calc_OPs</span><span class="p">(</span><span class="n">ordPars</span><span class="p">,</span> <span class="n">top_fname</span><span class="p">,</span> <span class="n">traj_fname</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ordPars</span>


<span class="c1">#######################################################################################</span>


<span class="k">def</span> <span class="nf">calc_angle</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">com</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd">    calculates the angle between the vector and z-axis in degrees</span>
<span class="sd">    no PBC check!</span>
<span class="sd">    Calculates the center of mass of the selected atoms to invert bottom leaflet vector</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">cos</span> <span class="o">=</span> <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">d</span>
    <span class="c1"># values for the bottom leaflet are inverted so that</span>
    <span class="c1"># they have the same nomenclature as the top leaflet</span>
    <span class="n">cos</span> <span class="o">*=</span> <span class="n">math</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">com</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">cos</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cos</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cosine is too large = </span><span class="si">{}</span><span class="s2"> --&gt; truncating it to +/-1.0&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cos</span><span class="p">))</span>
            <span class="n">cos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">cos</span><span class="p">)</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="n">cos</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">angle</span>


<span class="k">def</span> <span class="nf">calc_z_dim</span><span class="p">(</span><span class="n">gro</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd">    Returns the simulation box dimension in z-direction from coordinate file.</span>
<span class="sd">    </span>
<span class="sd">    :param gro: coordinate in ``gro``, ``pdb`` or corresponding format.</span>

<span class="sd">    :return: size of box z-direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">gro</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">z</span>

<div class="viewcode-block" id="system2MDanalysisUniverse">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.system2MDanalysisUniverse">[docs]</a>
<span class="k">def</span> <span class="nf">system2MDanalysisUniverse</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes the ``system`` dictionary as an input, downloads the required files to the NMRlipids databank directory and retuns MDAnalysis universe corressponding the ``system``.</span>

<span class="sd">    :param system: NMRlipids databank dictionary describing the simulation.</span>

<span class="sd">    :return: MDAnalysis universe</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)))</span>
    <span class="n">systemPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;/../../Data/Simulations/&#39;</span> <span class="o">+</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> 
    <span class="n">doi</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOI&#39;</span><span class="p">)</span>
    <span class="n">trj</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TRJ&#39;</span><span class="p">)</span>
    <span class="n">trj_name</span> <span class="o">=</span> <span class="n">systemPath</span> <span class="o">+</span> <span class="n">system</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TRJ&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">trj_url</span> <span class="o">=</span> <span class="n">download_link</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="n">trj</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">software</span><span class="o">=</span><span class="n">system</span><span class="p">[</span><span class="s1">&#39;SOFTWARE&#39;</span><span class="p">]</span>
    <span class="c1">#print(trj_name,tpr_name)</span>
                            
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">trj_name</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Downloading trajectory with the size of &#39;</span><span class="p">,</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;TRAJECTORY_SIZE&#39;</span><span class="p">],</span> <span class="s1">&#39; to &#39;</span><span class="p">,</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">])</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">trj_url</span><span class="p">,</span> <span class="n">trj_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;gromacs&#39;</span> <span class="ow">in</span> <span class="n">software</span><span class="p">:</span> 
        <span class="n">tpr</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TPR&#39;</span><span class="p">)</span>
        <span class="n">tpr_name</span> <span class="o">=</span> <span class="n">systemPath</span> <span class="o">+</span> <span class="n">system</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TPR&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">tpr_url</span> <span class="o">=</span> <span class="n">download_link</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="n">tpr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">tpr_name</span><span class="p">)):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">tpr_url</span><span class="p">,</span> <span class="n">tpr_name</span><span class="p">)</span>
            
        <span class="k">try</span><span class="p">:</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">tpr_name</span><span class="p">,</span> <span class="n">trj_name</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">conf</span> <span class="o">=</span> <span class="n">systemPath</span> <span class="o">+</span> <span class="s1">&#39;/conf.gro&#39;</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">tpr_name</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating conf.gro because MDAnalysis cannot read tpr version&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;WARNINGS&#39;</span> <span class="ow">in</span> <span class="n">system</span> <span class="ow">and</span> <span class="s1">&#39;GROMACS_VERSION&#39;</span> <span class="ow">in</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;WARNINGS&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;WARNINGS&#39;</span><span class="p">][</span><span class="s1">&#39;GROMACS_VERSION&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gromacs3&#39;</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;echo System | editconf -f &#39;</span><span class="o">+</span> <span class="n">tpr_name</span> <span class="o">+</span> <span class="s1">&#39; -o &#39;</span> <span class="o">+</span> <span class="n">conf</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;echo System | gmx trjconv -s &#39;</span><span class="o">+</span> <span class="n">tpr_name</span> <span class="o">+</span> <span class="s1">&#39; -f &#39;</span><span class="o">+</span> <span class="n">trj_name</span> <span class="o">+</span> <span class="s1">&#39; -dump 0 -o &#39;</span> <span class="o">+</span> <span class="n">conf</span><span class="p">)</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">conf</span><span class="p">,</span> <span class="n">trj_name</span><span class="p">)</span>

    <span class="k">elif</span> <span class="s1">&#39;openMM&#39;</span> <span class="ow">or</span> <span class="s1">&#39;NAMD&#39;</span> <span class="ow">in</span> <span class="n">software</span><span class="p">:</span>
        <span class="n">pdb</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PDB&#39;</span><span class="p">)</span>
        <span class="n">pdb_name</span> <span class="o">=</span> <span class="n">systemPath</span> <span class="o">+</span> <span class="n">system</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PDB&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pdb_url</span> <span class="o">=</span> <span class="n">download_link</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="n">pdb</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">pdb_name</span><span class="p">)):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">pdb_url</span><span class="p">,</span> <span class="n">pdb_name</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">pdb_name</span><span class="p">,</span> <span class="n">trj_name</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Other than gromacs, openMM or NAMD are yet to be implemented.&#39;</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">return</span> <span class="n">u</span></div>



<div class="viewcode-block" id="read_trj_PN_angles">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.read_trj_PN_angles">[docs]</a>
<span class="k">def</span> <span class="nf">read_trj_PN_angles</span><span class="p">(</span><span class="n">molname</span><span class="p">,</span> <span class="n">atom1</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">MDAuniverse</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the P-N vector angles with respect to membrane normal from the simulation defined by the MDAnalysis universe. </span>

<span class="sd">    :param molname: residue name of the molecule for which the P-N vector angle will be calculated</span>
<span class="sd">    :param atom1: name of the P atom in the simulation</span>
<span class="sd">    :param atom2: name of the N atom in the simulation</span>
<span class="sd">    :param MDAuniverse: MDAnalysis universe of the simulation to be analyzed</span>

<span class="sd">    :return: list where the first element are the angles of all molecules as a function of time, second element contains time averages for each molecule, third element contains the average angle over time and molecules, and fourth element is the error of the mean calculated over molecules. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#systemPath = os.path.dirname(os.path.realpath(__file__)) + system[&#39;path&#39;] </span>
    
    <span class="c1">#if &#39;gromacs&#39; in system[&#39;SOFTWARE&#39;]:</span>
    <span class="c1">#    print(systemPath, system[&#39;TPR&#39;][0][0])</span>
    <span class="c1">#    top_fname = systemPath + system[&#39;TPR&#39;][0][0]</span>
    <span class="c1">#else:</span>
    <span class="c1">#    top_fname = system[&#39;PDB&#39;]</span>
    <span class="c1">#traj_fname =  systemPath +  system[&#39;TRJ&#39;][0][0]</span>

    <span class="n">mol</span> <span class="o">=</span> <span class="n">MDAuniverse</span> <span class="c1">#mda.Universe(top_fname, traj_fname)</span>

    <span class="n">selection</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span>
        <span class="s2">&quot;resname &quot;</span> <span class="o">+</span> <span class="n">molname</span> <span class="o">+</span> <span class="s2">&quot; and (name &quot;</span> <span class="o">+</span> <span class="n">atom1</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;resname &quot;</span> <span class="o">+</span> <span class="n">molname</span> <span class="o">+</span> <span class="s2">&quot; and (name &quot;</span> <span class="o">+</span> <span class="n">atom2</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;residue&quot;</span><span class="p">)</span>
    <span class="n">com</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span>
        <span class="s2">&quot;resname &quot;</span> <span class="o">+</span> <span class="n">molname</span> <span class="o">+</span> <span class="s2">&quot; and (name &quot;</span> <span class="o">+</span> <span class="n">atom1</span> <span class="o">+</span> <span class="s2">&quot; or name &quot;</span> <span class="o">+</span> <span class="n">atom2</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">center_of_mass</span><span class="p">()</span>

    <span class="n">Nres</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
    <span class="n">Nframes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nres</span><span class="p">,</span> <span class="n">Nframes</span><span class="p">))</span>

    <span class="n">resAverageAngles</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">Nres</span>
    <span class="n">resSTDerror</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">Nres</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nres</span><span class="p">):</span>
            <span class="n">residue</span> <span class="o">=</span> <span class="n">selection</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">angles</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_angle</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">com</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Nres</span><span class="p">):</span>
        <span class="n">resAverageAngles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="n">Nframes</span>
        <span class="n">resSTDerror</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>

    <span class="n">totalAverage</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">resAverageAngles</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nres</span>
    <span class="n">totalSTDerror</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">resAverageAngles</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Nres</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">angles</span><span class="p">,</span> <span class="n">resAverageAngles</span><span class="p">,</span> <span class="n">totalAverage</span><span class="p">,</span> <span class="n">totalSTDerror</span></div>



<span class="c1">###############################################################################################################</span>


<span class="k">def</span> <span class="nf">calc_file_sha1_hash</span><span class="p">(</span><span class="n">fi</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd">    Calculates sha1 hash of given file using hashlib</span>

<span class="sd">    Args:</span>
<span class="sd">        fi (str): path to file</span>
<span class="sd">        step (int, optional): file read bytes step. Defaults to 4096.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: sha1 filehash of 40 char length</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sha1_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fi</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">fi</span><span class="p">)</span> <span class="o">/</span> <span class="n">step</span><span class="p">))</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
            <span class="c1"># Read and update hash string value in blocks of 4K</span>
            <span class="k">for</span> <span class="n">byte_block</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">step</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
                <span class="n">sha1_hash</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">byte_block</span><span class="p">)</span>
                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sha1_hash</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">create_databank_directories</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">sim_hashes</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd">    create nested output directory structure to save results</span>

<span class="sd">    Args:</span>
<span class="sd">        sim (_type_): Processed simulation entries</span>
<span class="sd">        sim_hashes (_type_): file hashes needed for directory structure</span>
<span class="sd">        out (str): output base path</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: unsupported simulation software</span>
<span class="sd">        OSError: Error while creating the output directory</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: output directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># resolve output dir naming</span>
    <span class="k">if</span> <span class="n">sim</span><span class="p">[</span><span class="s2">&quot;SOFTWARE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;gromacs&quot;</span><span class="p">:</span>
        <span class="n">head_dir</span> <span class="o">=</span> <span class="n">sim_hashes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TPR&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">sub_dir1</span> <span class="o">=</span> <span class="n">sim_hashes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TPR&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">sub_dir2</span> <span class="o">=</span> <span class="n">sim_hashes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TPR&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sub_dir3</span> <span class="o">=</span> <span class="n">sim_hashes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TRJ&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">sim</span><span class="p">[</span><span class="s2">&quot;SOFTWARE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;openMM&quot;</span> <span class="ow">or</span> <span class="n">sim</span><span class="p">[</span><span class="s2">&quot;SOFTWARE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;NAMD&quot;</span><span class="p">:</span>
        <span class="n">head_dir</span> <span class="o">=</span> <span class="n">sim_hashes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TRJ&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">sub_dir1</span> <span class="o">=</span> <span class="n">sim_hashes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TRJ&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">sub_dir2</span> <span class="o">=</span> <span class="n">sim_hashes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TRJ&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sub_dir3</span> <span class="o">=</span> <span class="n">sim_hashes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TRJ&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sim software &#39;</span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="s1">&#39;SOFTWARE&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; not supported&quot;</span><span class="p">)</span>

    <span class="n">directory_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">head_dir</span><span class="p">,</span> <span class="n">sub_dir1</span><span class="p">,</span> <span class="n">sub_dir2</span><span class="p">,</span> <span class="n">sub_dir3</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;output_dir = </span><span class="si">{</span><span class="n">directory_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># destination directory is not empty</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">directory_path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory_path</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;output directory &#39;</span><span class="si">{</span><span class="n">directory_path</span><span class="si">}</span><span class="s2">&#39; is not empty. Data may be overriden.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># create directories</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">directory_path</span>


<span class="c1"># Download link</span>
<span class="k">def</span> <span class="nf">download_link</span><span class="p">(</span><span class="n">doi</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>  <span class="c1"># deprecated?</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;    :meta private:&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;zenodo&quot;</span> <span class="ow">in</span> <span class="n">doi</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">zenodo_entry_number</span> <span class="o">=</span> <span class="n">doi</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;https://zenodo.org/record/&quot;</span> <span class="o">+</span> <span class="n">zenodo_entry_number</span> <span class="o">+</span> <span class="s2">&quot;/files/&quot;</span> <span class="o">+</span> <span class="n">file</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DOI provided: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">doi</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Repository not validated. Please upload the data for example to zenodo.org&quot;</span>        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>


<span class="k">def</span> <span class="nf">resolve_doi_url</span><span class="p">(</span><span class="n">doi</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">validate_uri</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd">    Returns full doi link of given ressource, also checks if URL is valid.</span>

<span class="sd">    Args:</span>
<span class="sd">        doi (str): [doi] part from config</span>
<span class="sd">        validate_uri (bool, optional): Check if URL is valid. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: full doi link</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;https://doi.org/&quot;</span> <span class="o">+</span> <span class="n">doi</span>

    <span class="k">if</span> <span class="n">validate_uri</span><span class="p">:</span>
        <span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># seconds</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>


<span class="k">def</span> <span class="nf">resolve_download_file_url</span><span class="p">(</span><span class="n">doi</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fi_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">validate_uri</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd">    Resolve file URI from supported DOI with given filename</span>

<span class="sd">    Args:</span>
<span class="sd">        doi (str): DOI string</span>
<span class="sd">        fi_name (str): name of the file to resolve from source</span>
<span class="sd">        validate_uri (bool, optional): Check if URI exists. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: Unsupported DOI repository</span>
<span class="sd">        HTTPError: HTTP Error Status Code</span>
<span class="sd">        URLError: Failed to reach the server</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: file URI</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;zenodo&quot;</span> <span class="ow">in</span> <span class="n">doi</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">zenodo_entry_number</span> <span class="o">=</span> <span class="n">doi</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;https://zenodo.org/record/&quot;</span> <span class="o">+</span> <span class="n">zenodo_entry_number</span> <span class="o">+</span> <span class="s2">&quot;/files/&quot;</span> <span class="o">+</span> <span class="n">fi_name</span>

        <span class="c1"># check if ressource exists, may throw exception</span>
        <span class="k">if</span> <span class="n">validate_uri</span><span class="p">:</span>
            <span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># seconds</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">uri</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Repository not validated. Please upload the data for example to zenodo.org&quot;</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">download_resource_from_uri</span><span class="p">(</span>
    <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dest</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">override_if_exists</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd">    Download file resource [from uri] to given file destination using urllib</span>

<span class="sd">    Args:</span>
<span class="sd">        uri (str): file URL</span>
<span class="sd">        dest (str): file destination path</span>
<span class="sd">        override_if_exists (bool, optional): Override dest. file if exists. Defaults to False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: HTTPException: An error occured during download</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO verify file size before skipping already existing download!</span>

    <span class="k">class</span> <span class="nc">RetrieveProgressBar</span><span class="p">(</span><span class="n">tqdm</span><span class="p">):</span>
        <span class="c1"># uses tqdm.update(), see docs https://github.com/tqdm/tqdm#hooks-and-callbacks</span>
        <span class="k">def</span> <span class="nf">update_retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tsize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">tsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">tsize</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">bsize</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>

    <span class="n">fi_name</span> <span class="o">=</span> <span class="n">uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># check if dest path already exists</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">override_if_exists</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">dest</span><span class="p">):</span>
        <span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># seconds</span>

        <span class="c1"># compare filesize</span>
        <span class="n">fi_size</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span><span class="o">.</span><span class="n">length</span>  <span class="c1"># download size</span>
        <span class="k">if</span> <span class="n">fi_size</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">dest</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dest</span><span class="si">}</span><span class="s2">: file already exists, skipping&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fi_name</span><span class="si">}</span><span class="s2"> filesize mismatch of local file &#39;</span><span class="si">{</span><span class="n">fi_name</span><span class="si">}</span><span class="s2">&#39;, redownloading ...&quot;</span>
            <span class="p">)</span>

    <span class="c1"># download</span>
    <span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># seconds</span>

    <span class="n">url_size</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span><span class="o">.</span><span class="n">length</span>  <span class="c1"># download size</span>

    <span class="k">with</span> <span class="n">RetrieveProgressBar</span><span class="p">(</span>
        <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">unit_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit_divisor</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">miniters</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">fi_name</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">u</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">reporthook</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">update_retrieve</span><span class="p">)</span>

    <span class="c1"># check if the file is fully downloaded</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">url_size</span> <span class="o">!=</span> <span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;downloaded filsize mismatch (</span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">url_size</span><span class="si">}</span><span class="s2"> B)&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">YamlBadConfigException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd">    Custom Exception class for parsing the yaml configuration</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="ne">Exception</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">parse_valid_config_settings</span><span class="p">(</span><span class="n">info_yaml</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :meta private:</span>
<span class="sd">    Parses, validates and updates dict entries from yaml configuration file.</span>

<span class="sd">    Args:</span>
<span class="sd">        info_yaml (dict): info.yaml of database to add</span>
<span class="sd">    Raises:</span>
<span class="sd">        KeyError: Missing required key in info.yaml</span>
<span class="sd">        YamlBadConfigException: Incorrect or incompatible configuration</span>
<span class="sd">    Returns:</span>
<span class="sd">        dict: updated sim dict</span>
<span class="sd">        list[str]: list of filenames to download</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sim</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">info_yaml</span><span class="p">)</span>  <span class="c1"># mutable objects are called by reference in Python</span>

    <span class="c1"># STEP 1 - check supported simulation software</span>
    <span class="k">if</span> <span class="s2">&quot;SOFTWARE&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;&#39;SOFTWARE&#39; Parameter missing in yaml&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sim</span><span class="p">[</span><span class="s2">&quot;SOFTWARE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">software_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simulation uses supported software &#39;</span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="s1">&#39;SOFTWARE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">YamlBadConfigException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Simulation uses unsupported software &#39;</span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="s1">&#39;SOFTWARE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="n">software_sim</span> <span class="o">=</span> <span class="n">software_dict</span><span class="p">[</span>
        <span class="n">sim</span><span class="p">[</span><span class="s2">&quot;SOFTWARE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="p">]</span>  <span class="c1"># related to dicts in this file</span>

    <span class="c1"># STEP 2 - check required keys defined by sim software used</span>
    <span class="n">software_required_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">software_sim</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;REQUIRED&quot;</span><span class="p">]]</span>

    <span class="c1"># are ALL required keys are present in sim dict and defined (not of NoneType) ?</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
        <span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">software_required_keys</span>
    <span class="p">):</span>
        <span class="n">missing_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">software_required_keys</span><span class="p">]</span>
        <span class="k">raise</span> <span class="n">YamlBadConfigException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Required &#39;</span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="s1">&#39;SOFTWARE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39; sim keys missing or not defined in conf file: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">missing_keys</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">software_required_keys</span><span class="p">)</span><span class="si">}</span><span class="s2"> required &#39;</span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="s1">&#39;SOFTWARE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39; sim keys are present&quot;</span>
    <span class="p">)</span>

    <span class="c1"># STEP 3 - check working directory</span>
    <span class="k">if</span> <span class="s2">&quot;DIR_WRK&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;&#39;DIR_WRK&#39; Parameter missing in yaml&quot;</span><span class="p">)</span>
    <span class="n">dir_wrk</span> <span class="o">=</span> <span class="n">sim</span><span class="p">[</span><span class="s2">&quot;DIR_WRK&quot;</span><span class="p">]</span>

    <span class="c1"># STEP 4 - Check that all entry keys provided for each simulation are valid</span>
    <span class="n">files_tbd</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">#   loop config entries</span>
    <span class="k">for</span> <span class="n">key_sim</span><span class="p">,</span> <span class="n">value_sim</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;processing entry: sim[&#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39;] = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">value_sim</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="s2">&quot;SOFTWARE&quot;</span><span class="p">:</span>  <span class="c1"># skip &#39;SOFTWARE&#39; entry</span>
            <span class="k">continue</span>

        <span class="c1"># STEP 4.1.</span>
        <span class="c1"># Anne: check if key is in molecules_dict, molecule_numbers_dict or molecule_ff_dict too</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">software_sim</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="ow">and</span> <span class="p">(</span><span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">molecules_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="ow">and</span> <span class="p">(</span><span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lipids_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="ow">and</span> <span class="p">(</span><span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">molecule_ff_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;key_sim &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39; in </span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="s1">&#39;SOFTWARE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">_dict&#39; : </span><span class="si">{</span><span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">software_sim</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;key_sim &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39; in molecules_dict : </span><span class="si">{</span><span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">molecules_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;key_sim &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39; in lipids_dict : </span><span class="si">{</span><span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">lipids_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;key_sim &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39; in molecule_ff_dict : </span><span class="si">{</span><span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">molecule_ff_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">YamlBadConfigException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39; not supported: Not found in &#39;</span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="s1">&#39;SOFTWARE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">_dict&#39;, &#39;molecules_dict&#39;, &#39;lipids_dict&#39; and &#39;molecule_ff_dict&#39;&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">software_sim</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">):</span>  <span class="c1"># hotfix for unkown yaml keys. TODO improve check 4.1?</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;ignoring yaml entry &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39;, not found in &#39;</span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="s1">&#39;SOFTWARE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">_dict&#39;&quot;</span>
            <span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># STEP 4.2.</span>
        <span class="c1"># entries with files information to contain file names in arrays</span>
        <span class="k">if</span> <span class="s2">&quot;TYPE&quot;</span> <span class="ow">in</span> <span class="n">software_sim</span><span class="p">[</span><span class="n">key_sim</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s2">&quot;file&quot;</span> <span class="ow">in</span> <span class="n">software_sim</span><span class="p">[</span><span class="n">key_sim</span><span class="p">][</span><span class="s2">&quot;TYPE&quot;</span><span class="p">]:</span>  <span class="c1"># entry_type</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;-&gt; found &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">software_sim</span><span class="p">[</span><span class="n">key_sim</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; of &#39;TYPE&#39; file&quot;</span>
                <span class="p">)</span>  <span class="c1"># DEBUG</span>

                <span class="k">if</span> <span class="n">value_sim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;entry &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39; has NoneType value, skipping&quot;</span><span class="p">)</span>
                <span class="c1"># already a list -&gt; ok</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_sim</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;value_sim &#39;</span><span class="si">{</span><span class="n">value_sim</span><span class="si">}</span><span class="s2">&#39; is already a list, skipping&quot;</span><span class="p">)</span>
                    <span class="n">files_tbd</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value_sim</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value_sim_splitted</span> <span class="o">=</span> <span class="n">value_sim</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_sim_splitted</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">YamlBadConfigException</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;found no file to download for entry &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">software_sim</span><span class="p">[</span><span class="n">key_sim</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                        <span class="p">)</span>
                    <span class="c1"># in case there are multiple files for one entry</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_sim_splitted</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">files_list</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">file_provided</span> <span class="ow">in</span> <span class="n">value_sim</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">):</span>
                            <span class="n">files_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">file_provided</span><span class="o">.</span><span class="n">strip</span><span class="p">()])</span>
                        <span class="n">sim</span><span class="p">[</span>
                            <span class="n">key_sim</span>
                        <span class="p">]</span> <span class="o">=</span> <span class="n">files_list</span>  <span class="c1"># replace ; separated string with list</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># print(f&quot;value_sim_splitted = {value_sim_splitted}&quot;)</span>
                        <span class="n">sim</span><span class="p">[</span><span class="n">key_sim</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">value_sim_splitted</span>
                        <span class="p">]</span>  <span class="c1"># IMPORTANT: Needs to be list of lists for now</span>
                    <span class="n">files_tbd</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">sim</span><span class="p">[</span><span class="n">key_sim</span><span class="p">])</span>
                    <span class="c1"># print(f&quot;sim[{key_sim}] = {sim[key_sim]}&quot;)</span>

                <span class="c1"># STEP 4.3.</span>
                <span class="c1"># Batuhan: In conf file only one psf/tpr/pdb file allowed each (can coexist), multiple TRJ files are ok</span>
                <span class="c1"># TODO true for all sim software?</span>
                <span class="c1"># TODO add dict entry param &quot;unique&quot; instead?</span>
                <span class="k">if</span> <span class="n">key_sim</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;PSF&quot;</span><span class="p">,</span> <span class="s2">&quot;TPR&quot;</span><span class="p">,</span> <span class="s2">&quot;PDB&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">key_sim</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">YamlBadConfigException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;only one &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39; entry file allowed, but got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="n">key_sim</span><span class="p">])</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">sim</span><span class="p">[</span><span class="n">key_sim</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;skipping key &#39;</span><span class="si">{</span><span class="n">key_sim</span><span class="si">}</span><span class="s2">&#39;: Not defined in software_sim library&quot;</span>
            <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">files_tbd</span><span class="p">)</span><span class="si">}</span><span class="s2"> ressources to download: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">files_tbd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">sim</span><span class="p">,</span> <span class="n">files_tbd</span>

<div class="viewcode-block" id="calcArea">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.calcArea">[docs]</a>
<span class="k">def</span> <span class="nf">calcArea</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns area of the calculated based on the area per lipid stored in the databank.</span>

<span class="sd">    :param system: a system dictionary</span>

<span class="sd">    :return: area of the system (Å^2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">APL</span> <span class="o">=</span> <span class="n">CalcAreaPerMolecule</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
    <span class="n">Nlipid</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">lipids_dict</span><span class="p">:</span>
            <span class="n">Nlipid</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;COUNT&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Nlipid</span><span class="p">,</span> <span class="n">APL</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Nlipid</span><span class="o">*</span><span class="n">APL</span><span class="o">/</span><span class="mi">2</span></div>


<div class="viewcode-block" id="GetFormFactorMin">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.GetFormFactorMin">[docs]</a>
<span class="k">def</span> <span class="nf">GetFormFactorMin</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return list of minima of form factor of ``system``.</span>

<span class="sd">    :param system: a system dictionary</span>

<span class="sd">    :return: list of form factor minima</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">FormFactorPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;/../../Data/Simulations/&#39;</span> <span class="o">+</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;FormFactor.json&#39;</span>
    <span class="c1">#try:</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">FormFactorPath</span><span class="p">)</span>
    <span class="n">FormFactor</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="nb">min</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">iprev</span> <span class="o">=</span> <span class="n">FormFactor</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">iprevD</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">minX</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">FormFactor</span><span class="p">:</span>
        <span class="n">iD</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">iprev</span>
        <span class="k">if</span> <span class="n">iD</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">iprevD</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="n">minX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">iprevD</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">iprev</span>
        <span class="n">iprev</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span><span class="p">(</span><span class="n">minX</span><span class="p">)</span></div>



<div class="viewcode-block" id="averageOrderParameters">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.averageOrderParameters">[docs]</a>
<span class="k">def</span> <span class="nf">averageOrderParameters</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns average order paramaters of sn-1 and sn-2 acyl chains based on universal atom names. The names starting with M_G1C will be assigned to sn-1 and names starting M_G2C to sn-2. </span>

<span class="sd">    :parameters system: a system dictionary</span>

<span class="sd">    :return: average of sn-1 and sn-2 order parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">#DataBankPath = &#39;../../Databank/Data/&#39;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;/../../Data/Simulations/&#39;</span> <span class="o">+</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span>
    <span class="c1">#DataBankPath + &#39;Simulations/&#39; +system[&#39;path&#39;]</span>
    
    <span class="n">sn1sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sn1count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sn2sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sn2count</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">lipid</span> <span class="ow">in</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">lipid</span> <span class="ow">in</span> <span class="n">lipids_dict</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;CHOL&#39;</span> <span class="ow">in</span> <span class="n">lipid</span><span class="p">:</span>
            <span class="n">OPpathSIM</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">lipid</span> <span class="o">+</span> <span class="s1">&#39;OrderParameters.json&#39;</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">OPpathSIM</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
                <span class="n">OPsim</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>
    
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">OPsim</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;M_G1C&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                    <span class="n">sn1sum</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">OPsim</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">sn1count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="s1">&#39;M_G2C&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                    <span class="n">sn2sum</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">OPsim</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">sn2count</span> <span class="o">+=</span> <span class="mi">1</span>
                    
    <span class="k">return</span> <span class="n">sn1sum</span><span class="o">/</span><span class="n">sn1count</span><span class="p">,</span> <span class="n">sn2sum</span><span class="o">/</span><span class="n">sn2count</span></div>


<div class="viewcode-block" id="calcLipidFraction">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.calcLipidFraction">[docs]</a>
<span class="k">def</span> <span class="nf">calcLipidFraction</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">lipid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the number fraction of ``lipid`` with respect to total number of lipids.</span>

<span class="sd">    :param system: a system dictionary</span>
<span class="sd">    :param lipid: universal molecule name of lipid</span>

<span class="sd">    :return: number fraction of ``lipid`` with respect total number of lipids</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">NlipidTOT</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">lipids_dict</span><span class="p">:</span>
            <span class="n">NlipidTOT</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;COUNT&#39;</span><span class="p">])</span>
    
    <span class="n">Nlipid</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">lipid</span> <span class="ow">in</span> <span class="n">molecule</span><span class="p">:</span>
            <span class="n">Nlipid</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;COUNT&#39;</span><span class="p">])</span>
            
    <span class="k">return</span> <span class="n">Nlipid</span><span class="o">/</span><span class="n">NlipidTOT</span></div>



<div class="viewcode-block" id="getHydrationLevel">
<a class="viewcode-back" href="../databankLibrary.html#databankLibrary.getHydrationLevel">[docs]</a>
<span class="k">def</span> <span class="nf">getHydrationLevel</span><span class="p">(</span><span class="n">system</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns hydration level of the system, i.e., number of water molecules divided by number of lipid molecules.</span>

<span class="sd">    :param system: a system dictionary</span>

<span class="sd">    :return: number of water molecules divided by number of lipid molecules</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Nlipid</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">lipids_dict</span><span class="p">:</span>
            <span class="n">Nlipid</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="n">molecule</span><span class="p">][</span><span class="s1">&#39;COUNT&#39;</span><span class="p">])</span>
    <span class="n">Nwater</span> <span class="o">=</span> <span class="n">system</span><span class="p">[</span><span class="s1">&#39;COMPOSITION&#39;</span><span class="p">][</span><span class="s1">&#39;SOL&#39;</span><span class="p">][</span><span class="s1">&#39;COUNT&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Nwater</span><span class="o">/</span><span class="n">Nlipid</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Samuli Ollila.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>